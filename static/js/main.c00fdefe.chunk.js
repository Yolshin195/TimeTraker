(this.webpackJsonpclient_time_treker=this.webpackJsonpclient_time_treker||[]).push([[0],{104:function(e,t,a){},13:function(e,t,a){"use strict";a.d(t,"b",(function(){return o}));var n=a(1),r=a.n(n),i=a(45),o={hostName:"https://timetraker.herokuapp.com",token:null},s=r.a.createContext({api:new i.a({hostName:o.hostName})});t.a=s},15:function(e,t,a){"use strict";t.a=function(e){var t=e.status,a=e.children;return t?a:null}},160:function(e,t,a){e.exports={Tasks:a(390).default}},161:function(e,t,a){e.exports={Timer:a(384).default}},18:function(e,t,a){e.exports={Modal:a(202).default}},191:function(e,t,a){e.exports=a(387)},196:function(e,t,a){},197:function(e,t,a){},198:function(e,t,a){},199:function(e,t,a){var n=a(200),r=["\u0412\u0441","\u041f\u043d","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041f\u0442","\u0421\u0431"];e.exports=function(e){var t=e.getDay(),a=n(e),i=n(new Date(e.getFullYear(),e.getMonth()-1)),o=42-(t+a),s=(new Date).getMonth()===e.getMonth(),l=s?(new Date).getDate():0;return[r,new Array(t).fill().map((function(e,t){return i-t})).reverse(),new Array(a).fill().map((function(e,t){return t+1})),new Array(o).fill().map((function(e,t){return 1+t})),s,l]}},200:function(e,t){e.exports=function(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}},201:function(e,t,a){"use strict";a.r(t);var n=a(72),r=a(12),i=a(8),o=a(9),s=a(5),l=a(11),c=a(10),u=a(1),m=a.n(u),d=a(97),h=a(46),f=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={currentDate:new Date,select:[]},n.onChangeFilter=n.onChangeFilter.bind(Object(s.a)(n)),n}return Object(o.a)(a,[{key:"getFirstAndLastMonth",value:function(e){return{from:new Date(e.getFullYear(),e.getMonth(),1),to:new Date(e.getFullYear(),e.getMonth()+1,0)}}},{key:"onChangeFilter",value:function(e){var t=this.state,a={},i=t.currentDate;switch(e){case"month":a={currentDate:new Date,select:[]};break;case"next":a=Object(r.a)(Object(r.a)({},t),{},{currentDate:new Date(i.getFullYear(),i.getMonth()+1)});break;case"previous":a=Object(r.a)(Object(r.a)({},t),{},{currentDate:new Date(i.getFullYear(),i.getMonth()-1)});break;default:if(isNaN(Number(e)))a={};else{var o=i.getFullYear(),s=i.getMonth(),l=Number(e),c=Object(h.formatDate)(new Date(o,s,l));a={select:t.select.includes(c)?t.select.filter((function(e){return e!==c})):[].concat(Object(n.a)(t.select),[c])}}}if(this.props.onChange)if(0===a.select.length){var u=a.currentDate?a.currentDate:t.currentDate;this.props.onChange(this.getFirstAndLastMonth(u))}else this.props.onChange(a.select);this.setState((function(e){return a}))}},{key:"render",value:function(){return m.a.createElement(d.default,{onChange:this.onChangeFilter,date:this.state.currentDate,select:this.state.select})}}]),a}(m.a.Component);t.default=f},202:function(e,t,a){"use strict";a.r(t);var n=a(67),r=a(8),i=a(9),o=a(5),s=a(11),l=a(10),c=a(1),u=a.n(c),m=(a(203),function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).onClose=n.onClose.bind(Object(o.a)(n)),n}return Object(i.a)(a,[{key:"onClose",value:function(e){if(e.target.classList.contains("modal"))return this.props.onClick()}},{key:"render",value:function(){if(this.props.show){var e=this.props.styleBody,t=void 0===e?{}:e,a=Object(n.a)(this.props.children),r=a[0],i=a[1],o=a.slice(2);return[u.a.createElement("div",{className:"modal",style:{display:"block"},role:"dialog",onClick:this.onClose},u.a.createElement("div",{className:"modal-dialog modal-dialog-scrollable",role:"document"},u.a.createElement("div",{className:"modal-content"},u.a.createElement("div",{className:"modal-header"},r,u.a.createElement("button",{onClick:this.props.onClick,type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},u.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),u.a.createElement("div",{className:"modal-body",style:t},i),u.a.createElement("div",{className:"modal-footer"},u.a.createElement("button",{key:"close",type:"button",className:"btn btn-secondary","data-dismiss":"modal",onClick:this.props.onClick},"Close"),o)))),u.a.createElement("div",{className:"modal-backdrop"})]}return null}}]),a}(u.a.Component));t.default=m},203:function(e,t,a){},204:function(e,t,a){},382:function(e,t,a){},383:function(e,t,a){},384:function(e,t,a){"use strict";a.r(t);var n=a(72),r=a(8),i=a(9),o=a(5),s=a(11),l=a(10),c=a(1),u=a.n(c),m=(a(385),a(13)),d=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={run:!1,timer_begin_date:null,timer_end_date:null,time:0,timerId:null,extraTime:0,timers:[],modelName:"timer",defoultTitle:""},n.timerId=null,n.onClick=n.onClick.bind(Object(o.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.state.modelName;this.context.api.list(t,{task_id:this.props.task_id}).then((function(t){return e.setState((function(){return{timers:t,extraTime:e.getExtraTime(t)}}))})).catch(console.log)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerId),document.title="Time Tracker",this.state.run&&this.state.time>=6e4&&this.context.api.add(this.state.modelName,{task_id:this.props.task_id,timer_begin_date:this.state.timer_begin_date,timer_end_date:new Date})}},{key:"onClick",value:function(){var e=this;this.setState((function(t){var a={};return t.run?(clearInterval(e.timerId),a.run=!1,a.timer_end_date=new Date,document.title="Time Tracker",t.time>=6e4&&(a.timers=[{timer_begin_date:t.timer_begin_date,timer_end_date:a.timer_end_date}].concat(Object(n.a)(t.timers)),a.extraTime=e.getExtraTime(a.timers),a.time=0,e.context.api.add(e.state.modelName,{task_id:e.props.task_id,timer_begin_date:t.timer_begin_date,timer_end_date:a.timer_end_date})),a):(e.timerId=setInterval((function(){var t=e.getTime();e.setState((function(){return{time:t}})),document.title="Time Tracker ".concat(e.TimeFormat(e.time(t)))}),200),{run:!0,timer_begin_date:new Date,timer_end_date:null})}))}},{key:"getExtraTime",value:function(e){return e.reduce((function(e,t){return e+(("string"===typeof t.timer_end_date?new Date(t.timer_end_date):t.timer_end_date)-("string"===typeof t.timer_begin_date?new Date(t.timer_begin_date):t.timer_begin_date))}),0)}},{key:"getTime",value:function(){return null===this.state.timer_begin_date?0:null===this.state.timer_end_date?new Date-this.state.timer_begin_date:this.state.timer_end_date-this.state.timer_begin_date}},{key:"time",value:function(e){return{h:Math.trunc(e/36e5%60),m:Math.trunc(e/6e4%60),s:Math.trunc(e/1e3%60)}}},{key:"TimeFormat",value:function(e){var t=e.h,a=e.m,n=e.s;return a=a>9?a:"0"+a,n=n>9?n:"0"+n,"".concat(t=t>9?t:"0"+t,":").concat(a,":").concat(n)}},{key:"TimeFormatH",value:function(e){return(e.h+e.m/60).toFixed(2)}},{key:"render",value:function(){var e=this.time(this.state.time+this.state.extraTime),t=this.state.run?"Timer-btn Timer-btn-danger":"Timer-btn Timer-btn-success";return u.a.createElement("div",{className:"Timer"},u.a.createElement("button",{className:t,onClick:this.onClick},this.TimeFormat(e)," - ",this.TimeFormatH(e)))}}]),a}(u.a.Component);d.contextType=m.a,t.default=d},385:function(e,t,a){},386:function(e,t,a){},387:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=a(62),o=a.n(i),s=(a(196),a(8)),l=a(9),c=a(11),u=a(10),m=a(17),d=a(5);a(104);var h=function(e){var t=e.signin,a=e.register,n=e.onChange,i=e.user_name,o=e.password,s=e.remember,l=e.isLoadding,c=e.error;return r.a.createElement("div",{className:"form-signin",onKeyPress:function(e){return"Enter"===e.key?t():null}},r.a.createElement("div",{className:"text-center mb-4"},r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Time Tracker")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"InputUsername"},"Username"),r.a.createElement("input",{type:"text",className:"form-control",id:"InputUsername","aria-describedby":"usernameHelp",placeholder:"Username",name:"user_name",onChange:n,value:i})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputPassword1"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"exampleInputPassword1",placeholder:"Password",name:"password",onChange:n,value:o})),r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"exampleCheck1",name:"remember",onChange:n,checked:s}),r.a.createElement("label",{className:"form-check-label",htmlFor:"exampleCheck1"},"Remember me")),r.a.createElement("div",{className:"btn-group btn-group-lg btn-group-form",role:"group","aria-label":"Basic example"},r.a.createElement("button",{className:"btn btn-outline-primary",type:"submit",onClick:a},"Register"),r.a.createElement("button",{className:"btn btn-primary",type:"submit",onClick:t},"Sign in")),l?r.a.createElement("div",{className:"alert alert-success mt-3 text-center",role:"alert"},"Loadding ..."):null,c?r.a.createElement("div",{className:"alert alert-danger mt-3 text-center",role:"alert"},c):null,r.a.createElement("p",{className:"mt-5 mb-3 text-muted text-center"},"\xa9 2019 - ",(new Date).getFullYear()))},f=a(16);var p=function(e){var t=e.signin,a=e.register,i=e.onChange,o=e.email,s=e.user_name,l=e.password,c=e.remember,u=Object(n.useState)(!1),m=Object(f.a)(u,2),d=m[0],h=m[1];return r.a.createElement("div",{className:"form-signin",onKeyPress:function(e){return"Enter"===e.key?a():null}},r.a.createElement("div",{className:"text-center mb-4"},r.a.createElement("h1",{className:"h3 mb-3 font-weight-normal"},"Time Tracker")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"InputEmail"},"Email"),r.a.createElement("input",{type:"email",className:"form-control",id:"InputEmail","aria-describedby":"emailHelp",placeholder:"Email",name:"email",onChange:i,value:o})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"InputUsername"},"Username"),r.a.createElement("input",{type:"text",className:"form-control",id:"InputUsername","aria-describedby":"usernameHelp",placeholder:"Username",name:"user_name",onChange:i,value:s})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"exampleInputPassword1"},"Password"),r.a.createElement("input",{type:"password",className:"form-control",id:"exampleInputPassword1",placeholder:"Password",name:"password",onChange:i,value:l})),r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"exampleCheck1",name:"remember",onChange:i,checked:c}),r.a.createElement("label",{className:"form-check-label",htmlFor:"exampleCheck1"},"Remember me")),r.a.createElement("div",{className:"form-group form-check"},r.a.createElement("input",{type:"checkbox",className:"form-check-input",id:"isMyPersonalData",name:"isMyPersonalData",onChange:function(e){var t=e.target;h(t.checked)},checked:d}),r.a.createElement("label",{className:"form-check-label",htmlFor:"isMyPersonalData"},"I agree to the processing of my personal data")),r.a.createElement("div",{className:"btn-group btn-group-lg btn-group-form",role:"group","aria-label":"Basic example"},r.a.createElement("button",{className:"btn btn-primary",type:"submit",onClick:a,onKeyDown:function(e){return"Enter"===e.key?a():null},disabled:!d},"Register"),r.a.createElement("button",{className:"btn btn-outline-primary",type:"submit",onClick:t},"Sign in")),r.a.createElement("p",{className:"mt-5 mb-3 text-muted text-center"},"\xa9 2019 - ",(new Date).getFullYear()))},g=a(13),b=a(45);function v(e,t){if(!window.localStorage)return null;localStorage.setItem(e,t)}function k(e){return window.localStorage||window.localStorage.length?localStorage.getItem(e):null}function w(e){return!!window.localStorage&&localStorage.removeItem(e)}var E=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=null,i="true"===k("remember");return i?r=k("token"):w("token"),n.state={isLoadding:!1,error:null,user_name:"",password:"",remember:i,status:"signin",api:new b.a({hostName:g.b.hostName,token:r||g.b.token}),authorized:!(!i||!r)},n.register=n.register.bind(Object(d.a)(n)),n.signIn=n.signIn.bind(Object(d.a)(n)),n.signOff=n.signOff.bind(Object(d.a)(n)),n.onChange=n.onChange.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"signOff",value:function(){w("token"),w("remember"),this.setState((function(){return{authorized:!1}}))}},{key:"onChange",value:function(e){var t=e.target;this.setState((function(){return t.hasOwnProperty("checked")?Object(m.a)({},t.name,t.checked):Object(m.a)({},t.name,t.value)}))}},{key:"signIn",value:function(){var e=this;return this.setState({isLoadding:!0,error:null}),this.state.api.signIn({user_name:this.state.user_name,password:this.state.password}).then((function(t){var a=t.token;v("token",a),v("remember",e.state.remember),e.setState((function(){return{api:new b.a({hostName:g.b.hostName,token:a}),authorized:!!a,isLoadding:!1,error:null}}))})).catch((function(t){return e.setState((function(){return{isLoadding:!1,error:"Login failed"}}))}))}},{key:"register",value:function(){var e=this;return this.state.api.register({user_name:this.state.user_name,password:this.state.password,email:this.state.email,type:"user"}).then((function(t){var a=t.token;return e.signIn(a)})).catch(console.log)}},{key:"render",value:function(){var e=this;return this.state.authorized?r.a.createElement(g.a.Provider,{value:{api:this.state.api,signOff:this.signOff}},this.props.children,";"):"signin"===this.state.status?r.a.createElement(h,Object.assign({},this.state,{register:function(){return e.setState((function(){return{status:"register"}}))},signin:this.signIn,onChange:this.onChange})):"register"===this.state.status?r.a.createElement(p,Object.assign({},this.state,{signin:function(){return e.setState((function(){return{status:"signin"}}))},register:this.register,onChange:this.onChange})):void 0}}]),a}(r.a.Component);E.contextType=g.a;var y=E,N=(a(197),a(12)),C=(a(74),a(65)),O=a(71).a,S=a(26),_=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={width:1e3},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState((function(){return{width:e.container.offsetWidth}}))}},{key:"render",value:function(){var e=this,t=this.props.data;return r.a.createElement("div",{ref:function(t){return e.container=t}},r.a.createElement(S.d,{width:this.state.width,height:300,data:t,margin:{top:5,right:30,left:20,bottom:5}},r.a.createElement(S.a,{strokeDasharray:"3 3"}),r.a.createElement(S.f,{dataKey:"name"}),r.a.createElement(S.g,null),r.a.createElement(S.e,null),r.a.createElement(S.b,null),r.a.createElement(S.c,{type:"monotone",dataKey:"hours",stroke:"#8884d8",activeDot:{r:8}})))}}]),a}(n.PureComponent);_.jsfiddleUrl="https://jsfiddle.net/alidingling/xqjtetw0/";var j=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"getTimerToTime",value:function(e){return("string"===typeof e.timer_end_date?new Date(e.timer_end_date):e.timer_end_date)-("string"===typeof e.timer_begin_date?new Date(e.timer_begin_date):e.timer_begin_date)}},{key:"Time",value:function(e){return{h:Math.trunc(e/36e5),m:Math.trunc(e/6e4%60),s:Math.trunc(e/1e3%60)}}},{key:"TimeFormatH",value:function(e){return(e.h+e.m/60).toFixed(2)}},{key:"getHoursNumber",value:function(e){var t=this.Time(e);return t.h+t.m/60}},{key:"getHours",value:function(e){return this.TimeFormatH(this.Time(e))}},{key:"getData",value:function(e){var t=this,a={};e.forEach((function(e){var n=new Date(e.timer_begin_date).getDate();a.hasOwnProperty(n)?a[n]+=t.getTimerToTime(e):a[n]=t.getTimerToTime(e)}));var n=[],r=this.props.filter.date_create;return r instanceof Array||(n=this.getDataMonth(r)),n.map((function(e){return a.hasOwnProperty(e)?t.createItem(e,Number(t.getHours(a[e]))):t.createItem(e,0)}))}},{key:"getDataMonth",value:function(e){var t=e.from,a=(e.to,new Date(t)),n=32-new Date(a.getFullYear(),a.getMonth(),32).getDate();return new Array(n).fill(0).map((function(e,t){return t+1}))}},{key:"getDataDays",value:function(e){}},{key:"createItem",value:function(e,t){return{name:e,hours:t,amt:2400}}},{key:"render",value:function(){var e=this,t=this.props,a=t.filter,n=t.tasks,i=t.timers,o=t.prices,s=this.getData(i),l=i.reduce((function(t,a){return t+e.getTimerToTime(a)}),0),c=n.reduce((function(e,t){return e[t.id]=t,e}),{}),u=i.reduce((function(t,a){var n=c[a.task_id];if(!n)return t;var r=function(n){var r=n.fixed,i=n.price;if(r)return i;var o=e.getHoursNumber(e.getTimerToTime(a));return Number(o)*Number(i)+t};return o.task_id.hasOwnProperty(n.id)?r(o.task_id[n.id]):o.client_id.hasOwnProperty(n.client_id)?r(o.client_id[n.client_id]):o.category_id.hasOwnProperty(n.category_id)?r(o.category_id[n.category_id]):t}),0);return console.log(n,i,o,l),r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement(T,{date:a.date_create})),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",{className:"card-text"},"Total tasks: ",n.length),r.a.createElement("p",{className:"card-text"},"Total time: ",this.getHours(l)," h."),r.a.createElement("p",{className:"card-text"},"Total money: ",u.toFixed(0)," \u0440.")),r.a.createElement(_,{data:s}))}}]),a}(r.a.Component);function T(e){var t=e.date,a="Statistics";if(t instanceof Array)a+=": ".concat(t.map((function(e){return e.split("-").reverse().join(".")})));else{var n=new Date(t.from).toLocaleDateString(),r=new Date(t.to).toLocaleDateString();a+=": from ".concat(n," to ").concat(r)}return a}j.contextType=g.a;var D=j,x=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={tasks:[],timers:[],prices:{task_id:{},client_id:{},category_id:{}}},n.handleChangeFilter=n.handleChangeFilter.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.getTasks().then((function(){return e.getPrices()})).then((function(){return e.getTimers()})).catch(console.log)}},{key:"handleChangeFilter",value:function(e,t){var a=this;this.props.onChangeFilter&&this.props.onChangeFilter(e,t);var n=Object(N.a)(Object(N.a)({},this.props.filter),{},Object(m.a)({},e,t));this.getTasks(n).then((function(){if(0===a.state.tasks.length)return a.setState((function(){return{prices:{task_id:{},client_id:{},category_id:{}}}}));a.getPrices()})).then((function(){if(0===a.state.tasks.length)return a.setState((function(){return{timers:[]}}));a.getTimers(n)})).catch(console.log)}},{key:"getPrices",value:function(){var e=this,t={task_id:this.state.tasks.map((function(e){return e.id}))},a={client_id:M(this.state.tasks.filter((function(e){return!!e.client_id})).map((function(e){return e.client_id})))},n={category_id:M(this.state.tasks.filter((function(e){return!!e.category_id})).map((function(e){return e.category_id})))};return Promise.all([this.context.api.list("price",t).then((function(e){return e.reduce((function(e,t){return e[t.task_id]=t,e}),{})})),this.context.api.list("price",a).then((function(e){return e.reduce((function(e,t){return e[t.client_id]=t,e}),{})})),this.context.api.list("price",n).then((function(e){return e.reduce((function(e,t){return e[t.category_id]=t,e}),{})}))]).then((function(t){return e.setState((function(){return{prices:{task_id:t[0],client_id:t[1],category_id:t[2]},isLoading:!1,isError:!1}}))})).catch((function(t){return e.setState((function(){return{isError:!0,isLoading:!1}}))}))}},{key:"getTasks",value:function(e){var t=this;return e||(e=this.props.filter),this.context.api.list("task",e).then((function(e){return t.setState((function(){return{tasks:e,isLoading:!1,isError:!1}}))})).catch((function(e){return t.setState((function(){return{isError:!0,isLoading:!1}}))}))}},{key:"getTimers",value:function(e){var t=this;return e||(e=this.props.filter),e={timer_begin_date:e.date_create,task_id:this.state.tasks.map((function(e){return e.id}))},this.context.api.list("timer",e).then((function(e){return t.setState((function(){return{timers:e,isLoading:!1}}))})).catch((function(e){return t.setState((function(){return{isError:!0,isLoading:!1}}))}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Page"},r.a.createElement("div",{className:"Header"},r.a.createElement("nav",{className:"navbar navbar-light bg-light"},r.a.createElement("a",{className:"navbar-brand",href:"/"},"Time Tracker"),r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:"btn btn-outline-success",type:"button",onClick:function(){e.context.api.exportExcel("task",e.props.filter).then(console.log).catch(console.log)}},"Export excel"),r.a.createElement("button",{className:"btn btn-outline-danger",type:"button",onClick:function(){return e.context.signOff()}},"Sign out")))),r.a.createElement("div",{className:"Nav"},r.a.createElement(C.FilterDate,{onChange:function(t){return e.handleChangeFilter("date_create",t)}}),r.a.createElement(O,{label:"Filter category",value:this.props.filter.category_id,modelName:"category",onChange:function(t,a){return e.handleChangeFilter("category_id",a)}}),r.a.createElement(O,{label:"Filter client",value:this.props.filter.client_id,modelName:"client",filter:{category_id:this.props.filter.category_id},onChange:function(t,a){return e.handleChangeFilter("client_id",a)}}),r.a.createElement(O,{label:"Set price",modelName:"price"}),r.a.createElement("button",{type:"button",className:"btn btn-block btn-outline-primary",onClick:function(){return e.props.setPage("task")}},"list task")),r.a.createElement("div",{className:"Article"},r.a.createElement(D,{filter:this.props.filter,timers:this.state.timers,tasks:this.state.tasks,prices:this.state.prices}))))}}]),a}(r.a.Component);function M(e){var t={};return e.filter((function(e){return!t.hasOwnProperty(e)&&(t[e]=!0,!0)}))}x.contextType=g.a;var R=x,F=a(160),P=a(48).a,I=a(15),L=a(18),A=a(68),U=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={isLoadding:!1,isError:!1,clients:[],tasks:[],timers:[],modal:!1,modalNew:!1,modalDelete:!1,formTask:{},modelName:"task",keys:[],fields:{},currentPage:"task"},n.getTasks=n.getTasks.bind(Object(d.a)(n)),n.onUpdate=n.onUpdate.bind(Object(d.a)(n)),n.onDel=n.onDel.bind(Object(d.a)(n)),n.onAdd=n.onAdd.bind(Object(d.a)(n)),n.handleCloseModal=n.handleCloseModal.bind(Object(d.a)(n)),n.handleShowTask=n.handleShowTask.bind(Object(d.a)(n)),n.handleChange=n.handleChange.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.context.api.desctiption(this.state.modelName).then((function(t){return e.setState((function(){return{keys:t.keys||[],fields:t.fields||{},isLoadding:!1,isError:!1}}))})).then(this.getTasks).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"getTasks",value:function(e){var t=this;return e||(e=this.props.filter),this.context.api.list(this.state.modelName,e).then((function(e){return t.setState((function(){return{tasks:e,isLoading:!1,isError:!1}}))})).catch((function(e){return t.setState((function(){return{isError:!0,isLoading:!1}}))}))}},{key:"onUpdate",value:function(){var e=this;return this.context.api.update(this.state.modelName,this.state.formTask,{id:this.state.formTask.id}).then((function(){return e.setState((function(e){return{modal:!1,madalNew:!1,tasks:e.tasks.map((function(t){return t.id===e.formTask.id?e.formTask:t}))}}))})).catch(console.log)}},{key:"onDel",value:function(){var e=this;return this.context.api.del(this.state.modelName,this.state.formTask.id).then((function(){return e.setState((function(e){return{modal:!1,madalNew:!1,modalDelete:!1,tasks:e.tasks.filter((function(t){return t.id!==e.formTask.id}))}}))})).catch(console.log)}},{key:"onAdd",value:function(e){var t=this;for(var a in e)if(""===e[a])return null;this.context.api.add(this.state.modelName,e).then((function(){return t.getTasks()})).then((function(){return t.handleCloseModal()})).catch(console.log)}},{key:"handleChange",value:function(e,t){var a=this;return console.log(e,t),this.setState((function(){return{formTask:Object(N.a)(Object(N.a)({},a.state.formTask),{},Object(m.a)({},e,t))}}))}},{key:"handleShowTask",value:function(e,t){if(!e.classList.contains("Timer-btn")){var a=this.state.tasks.find((function(e){return e.id===t}));this.setState((function(){return{formTask:a,modal:!0,modalNew:!1}}))}}},{key:"handleCloseModal",value:function(){this.setState((function(){return{modal:!1,modalNew:!1}}))}},{key:"handleChangeFilter",value:function(e,t){this.props.onChangeFilter&&this.props.onChangeFilter(e,t),this.getTasks(Object(N.a)(Object(N.a)({},this.props.filter),{},Object(m.a)({},e,t)))}},{key:"render",value:function(){var e=this;return console.log(this.state,this.props),r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Page"},r.a.createElement("div",{className:"Header"},r.a.createElement("nav",{className:"navbar navbar-light bg-light"},r.a.createElement("a",{className:"navbar-brand",href:"/"},"Time Tracker"),r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{className:"btn btn-outline-success",type:"button",onClick:function(){return e.setState({modal:!0,modalNew:!0,formTask:{client_id:e.props.filter.client_id,category_id:e.props.filter.category_id,date_create:(new Date).getTime()}})}},"New Task"),r.a.createElement("button",{className:"btn btn-outline-success",type:"button",onClick:function(){e.context.api.exportExcel(e.state.modelName,e.props.filter).then(console.log).catch(console.log)}},"Export excel"),r.a.createElement("button",{className:"btn btn-outline-danger",type:"button",onClick:function(){return e.context.signOff()}},"Sign out")))),r.a.createElement("div",{className:"Nav"},r.a.createElement(C.FilterDate,{onChange:function(t){return e.handleChangeFilter("date_create",t)}}),r.a.createElement(O,{label:"Filter category",value:this.props.filter.category_id,modelName:"category",onChange:function(t,a){return e.handleChangeFilter("category_id",a)}}),r.a.createElement(O,{label:"Filter client",value:this.props.filter.client_id,modelName:"client",filter:{category_id:this.props.filter.category_id},onChange:function(t,a){return e.handleChangeFilter("client_id",a)}}),r.a.createElement(O,{label:"Set price",modelName:"price"}),r.a.createElement("button",{type:"button",className:"btn btn-block btn-outline-primary",onClick:function(){return e.props.setPage("statistics")}},"statistics")),r.a.createElement("div",{className:"Article"},r.a.createElement(F.Tasks,{tasks:this.state.tasks,error:this.state.isError,loading:this.state.isLoading,onShowTask:this.handleShowTask}))),r.a.createElement(I.a,{status:this.state.modalNew&&this.state.modal},r.a.createElement(L.Modal,{show:this.state.modal,onClick:this.handleCloseModal},r.a.createElement("h5",{key:"title",className:"modal-title"},"New task"),r.a.createElement(P,{row:this.state.formTask,keys:this.state.keys,fields:this.state.fields,onChange:this.handleChange}),r.a.createElement("button",{key:"add",onClick:function(){return e.onAdd(e.state.formTask)},className:"btn btn-success"},"Add"))),r.a.createElement(I.a,{status:!this.state.modalNew&&this.state.modal},r.a.createElement(L.Modal,{show:this.state.modal,onClick:this.handleCloseModal},r.a.createElement("h5",{key:"title",className:"modal-title"},"Show task"),r.a.createElement(P,{row:this.state.formTask,keys:this.state.keys,fields:this.state.fields,onChange:this.handleChange}),r.a.createElement("button",{key:"delete",onClick:function(){return e.setState((function(){return{modalDelete:!0}}))},className:"btn btn-danger"},"Delete"),",",r.a.createElement("button",{key:"update",onClick:this.onUpdate,className:"btn btn-success"},"Update"))),r.a.createElement(I.a,{status:this.state.modalDelete},r.a.createElement(A.a,{show:this.state.modalDelete,modelName:this.state.modelName,id:this.state.formTask.id,onDelete:this.onDel,onClose:function(){return e.setState((function(){return{modalDelete:!1}}))}})))}}]),a}(r.a.Component);U.contextType=g.a;var Y={task:U,statistics:R};function B(e){return e>9?e:"0"+e}function H(e){var t=e.getFullYear(),a=e.getMonth()+1,n=e.getDate();return"".concat(t,"-").concat(B(a),"-").concat(B(n))}var J=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(s.a)(this,a),n=t.call(this,e);var r=new Date,i=new Date(r.getFullYear(),r.getMonth(),1),o=new Date(r.getFullYear(),r.getMonth()+1,0);return n.state={filter:{date_create:{from:H(i),to:H(o)}},currentPage:"task"},n.handleChangeFilter=n.handleChangeFilter.bind(Object(d.a)(n)),n.setPage=n.setPage.bind(Object(d.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"handleChangeFilter",value:function(e,t){return this.setState((function(a){return{filter:Object(N.a)(Object(N.a)({},a.filter),{},Object(m.a)({},e,t))}}))}},{key:"setPage",value:function(e){return this.setState((function(){return{currentPage:e}}))}},{key:"render",value:function(){var e=Y[this.state.currentPage];return r.a.createElement(e,Object.assign({},this.state,{setPage:this.setPage,onChangeFilter:this.handleChangeFilter}))}}]),a}(r.a.Component);a(386);var K=function(){var e=Object(n.useState)(!1),t=Object(f.a)(e,2),a=t[0],i=t[1];return r.a.createElement("div",null,r.a.createElement("button",{className:"btn btn-link text-muted",style:{padding:0},onClick:function(){return i(!0)}},"About"),r.a.createElement(L.Modal,{show:a,onClick:function(){return i(!1)}},r.a.createElement("h5",{className:"modal-title"},"About"),r.a.createElement("div",null,r.a.createElement("p",null,"The solution was written as part of the final qualification work"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://docs.google.com/document/d/1IbuLndxW0JhQYmn_na1NqVQmcmjZERRkyLzbcZFBZQI/edit?usp=sharing",rel:"noopener noreferrer",target:"_blank"},"explanatory note for final qualifying work")),r.a.createElement("p",null,r.a.createElement("a",{href:"https://docs.google.com/presentation/d/1iYA9qmHtbRuiEecUrXwi8ViMiWkFaKy0dTsK1MsxwQA/edit?usp=sharing",rel:"noopener noreferrer",target:"_blank"},"Presentation for final qualification work")),r.a.createElement("p",null,"Author: ",r.a.createElement("author",null,"Yolshin Alexey")))))};var z=function(){return r.a.createElement("footer",{className:"footer mt-auto py-3"},r.a.createElement("div",{className:"container d-flex justify-content-between"},r.a.createElement("a",{href:"https://docs.google.com/document/d/1HBF-IrXkgEDs6zOd-cR_U8S_ZAORNFY3ecJrnv0S0zk/edit?usp=sharing",className:"text-muted",rel:"noopener noreferrer",target:"_blank"},"User guides"),r.a.createElement(K,null)))},q=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(s.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return[r.a.createElement("main",{className:"flex-shrink-0"},r.a.createElement(y,null,r.a.createElement(J,null))),r.a.createElement(z,null)]}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},388:function(e,t,a){"use strict";a.r(t);var n=a(16),r=a(1),i=a.n(r);var o=function(e){var t=e.label,a=e.value,n=e.onChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:t},t),i.a.createElement("input",{type:"text",className:"form-control",id:t,placeholder:"Enter ".concat(t),value:a,onChange:function(e){var a=e.target;n(t,a.value)}}))};var s=function(e){var t=e.label,a=e.value,o=e.onChange,s=new Date(a),l=Object(r.useState)(s.toLocaleTimeString()),c=Object(n.a)(l,2),u=c[0],m=c[1],d=Object(r.useState)(s.toLocaleDateString().split(".").reverse().join("-")),h=Object(n.a)(d,2),f=h[0],p=h[1],g=function(e){var a=e.target;return"date"===a.name&&p(a.value),"time"===a.name&&m(a.value),o(t,new Date("".concat(f,"T").concat(u)).getTime())};return i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:t},"date ",t),i.a.createElement("div",{className:"input-group"},i.a.createElement("input",{type:"date",name:"date",className:"form-control",id:t,placeholder:"Enter ".concat(t),value:f,onChange:g}),i.a.createElement("input",{type:"time",name:"time",className:"form-control",id:t,placeholder:"Enter ".concat(t),value:u,onChange:g})))},l=a(71);var c=function(e){var t=e.label,a=e.value,n=void 0!==a&&a,r=e.onChange;return i.a.createElement("div",{className:"form-group form-check"},i.a.createElement("input",{type:"checkbox",className:"form-check-input",id:t,checked:n,onChange:function(e){var a=e.target;r(t,Boolean(a.checked))}}),i.a.createElement("label",{className:"form-check-label",htmlFor:t},"Check ",t))};var u=function(e){var t=e.label,a=e.value,n=e.onChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:t},t),i.a.createElement("textarea",{className:"form-control",id:t,rows:"3",onChange:function(e){var a=e.target;n(t,a.value)},placeholder:"Enter ".concat(t)},a))};var m=function(e){var t=e.label,a=e.value,n=e.onChange;return i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:t},t),i.a.createElement("input",{type:"number",className:"form-control",id:t,placeholder:"Enter ".concat(t),value:a,onChange:function(e){var a=e.target;n(t,Number(a.value))}}))};t.default=function(e){var t=e.type,a=void 0===t?"":t,r=e.label,d=e.value,h=e.onChange,f=a.split("&"),p=Object(n.a)(f,2),g=p[0],b=p[1];switch(g.toLocaleLowerCase()){case"date":return i.a.createElement(s,{label:r,value:d,onChange:h});case"boolean":return i.a.createElement(c,{label:r,value:d,onChange:h});case"text":return i.a.createElement(u,{label:r,value:d,onChange:h});case"model":return i.a.createElement(l.a,{label:r,modelName:b,value:d,onChange:h});case"number":return i.a.createElement(m,{label:r,value:d,onChange:h});default:return i.a.createElement(o,{label:r,value:d,onChange:h})}}},389:function(e,t,a){"use strict";a.r(t);var n=a(16),r=a(1),i=a.n(r);var o=function(e){var t=e.label,a=e.value;return i.a.createElement("div",{className:"form-group row"},i.a.createElement("label",{htmlFor:t,className:"col-sm-3 col-form-label"},t),i.a.createElement("div",{className:"col-sm-9"},i.a.createElement("input",{type:"text",readOnly:!0,className:"form-control-plaintext",id:t,defaultValue:a})))};var s=function(e){var t=e.label,a=e.value,n=void 0!==a&&a;return i.a.createElement("div",{className:"form-group form-check"},i.a.createElement("input",{type:"checkbox",className:"form-check-input",id:t,defaultChecked:Boolean(n),readOnly:!0}),i.a.createElement("label",{className:"form-check-label",htmlFor:t},t))};t.default=function(e){var t,a=e.type,r=void 0===a?"":a,l=e.label,c=e.value,u=r.toLocaleLowerCase().split("-");switch(Object(n.a)(u,1)[0]){case"date":return i.a.createElement(o,{label:l,value:(t=c,new Date(Number(t)).toLocaleDateString())});case"boolean":return i.a.createElement(s,{label:l,value:c});case"model":default:return i.a.createElement(o,{label:l,value:c})}}},390:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=(a(382),a(383),a(161)),o=a(8),s=a(9),l=a(11),c=a(10),u=a(13),m=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={row:{},error:null},n}return Object(s.a)(a,[{key:"getModel",value:function(){var e=this,t=this.props,a=t.modelName,n=t.id;this.context.api.view(a,n).then((function(t){return e.setState((function(){return{row:t[0]}}))})).catch((function(t){return e.setState((function(){return{error:t}}))}))}},{key:"componentDidMount",value:function(){this.getModel()}},{key:"render",value:function(){var e=this.props,t=e.id,a=e.label,n=this.state.row;return n&&n.hasOwnProperty(a||"title")?n[a||"title"]:t}}]),a}(r.a.Component);m.contextType=u.a;var d=m;var h=function(e){var t=e.id,a=e.date_create,n=e.client_id,o=e.title,s=e.onClick;return r.a.createElement("li",{onDoubleClick:s,className:"list-group-item list-group-item-action",style:{padding:"0px",cursor:"pointer"}},r.a.createElement("div",{key:t,className:"Task"},r.a.createElement("div",{className:"Task-date"},new Date(a).toLocaleDateString()),r.a.createElement("div",{className:"Task-client"},r.a.createElement(d,{modelName:"client",id:n})),r.a.createElement("div",{className:"Task-description"},o),r.a.createElement("div",{className:"Task-timer"},r.a.createElement(i.Timer,{task_id:t}))))};t.default=function(e){for(var t=e.tasks,a=e.error,n=e.loading,i=e.onShowTask,o=[];;){if(a){o.push(r.a.createElement("div",{key:"TasksError",className:"TasksError"},"Error loading tasks"));break}if(n){o.push(r.a.createElement("div",{key:"TakssLoading",className:"TakssLoading"},"... Loading tasks"));break}t&&t.length>0?o=t.map((function(e){return r.a.createElement(h,Object.assign({onClick:function(t){var a=t.target;return i(a,e.id)},key:e.id},e))})):o.push(r.a.createElement("div",{key:"NoTasks",className:"NoTasks"},"No tasks"));break}return r.a.createElement("ul",{className:"list-gruop"},r.a.createElement("li",{className:"list-group-item",style:{padding:"0px"}},r.a.createElement("div",{className:"Task"},r.a.createElement("div",{className:"Task-date Task-heade-item-first"},"Date"),r.a.createElement("div",{className:"Task-client"},"Client"),r.a.createElement("div",{className:"Task-description"},"Description"),r.a.createElement("div",{className:"Task-timer Task-heade-timer"},"Timer"))),o)}},45:function(e,t,a){"use strict";var n=a(8),r=a(9),i=function(){function e(t){Object(n.a)(this,e),this.token=t.token||null,this.hostName=t.hostName}return Object(r.a)(e,[{key:"setToken",value:function(e){this.token=e}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return fetch(e).then((function(e){return e.json()})).then((function(e){return"ok"!==e.status?Promise.reject(e.error):Promise.resolve(e.response)}))}))},{key:"fetchPost",value:function(e,t){var a="body=".concat(JSON.stringify(t));return fetch(e,{method:"POST",body:a}).then((function(e){return e.json()})).then((function(e){return"ok"!==e.status?Promise.reject(e.error):Promise.resolve(e.response)}))}},{key:"register",value:function(e){var t={set:e},a="".concat(this.hostName,"?cmd=register&data=").concat(t);return this.fetchPost(a,t)}},{key:"signIn",value:function(e){var t={where:e},a="".concat(this.hostName,"?cmd=signin");return this.fetchPost(a,t)}},{key:"add",value:function(e,t){var a=JSON.stringify({model:e,set:t}),n="".concat(this.hostName,"?cmd=add&data=").concat(a,"&sig=").concat(this.token);return this.fetch(n)}},{key:"update",value:function(e,t,a){var n=JSON.stringify({model:e,set:t,where:a}),r="".concat(this.hostName,"?cmd=update&data=").concat(n,"&sig=").concat(this.token);return this.fetch(r)}},{key:"list",value:function(e,t){var a={model:e};(function(e){for(var t in e)return!1;return!0})(t)||(a.where=t);var n="".concat(this.hostName,"?cmd=list&data=").concat(JSON.stringify(a),"&sig=").concat(this.token);return this.fetch(n)}},{key:"view",value:function(e,t){var a=JSON.stringify({model:e,id:t}),n="".concat(this.hostName,"?cmd=view&data=").concat(a,"&sig=").concat(this.token);return this.fetch(n)}},{key:"del",value:function(e,t){var a=JSON.stringify({model:e,id:t}),n="".concat(this.hostName,"?cmd=del&data=").concat(a,"&sig=").concat(this.token);return this.fetch(n)}},{key:"exportExcel",value:function(e,t){var a=JSON.stringify({model:e,where:t}),n="".concat(this.hostName,"?cmd=excel&data=").concat(a,"&sig=").concat(this.token);return console.log("export excel: ",a),console.log("url: ",n),window.open(n),Promise.resolve(null)}},{key:"desctiption",value:function(e){var t=JSON.stringify({model:e}),a="".concat(this.hostName,"?cmd=descriptor&data=").concat(t,"&sig=").concat(this.token);return this.fetch(a)}}]),e}();t.a=i},46:function(e,t,a){function n(e){return e>9?e:"0"+e}e.exports={getMonth:a(199),formatDate:function(e){var t=e.getFullYear(),a=e.getMonth()+1,r=e.getDate();return"".concat(t,"-").concat(n(a),"-").concat(n(r))}}},48:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(67),o=a(388).default,s=a(389).default;var l=function(e){var t=e.type,a=void 0===t?"":t,n=e.label,l=e.value,c=e.onChange,u=a.toLocaleLowerCase().split("&"),m=Object(i.a)(u),d=m[0],h=m.slice(1);switch(d){case"delete":return null;case"label":return r.a.createElement(s,{type:h.join("&"),label:n,value:l});case"input":return r.a.createElement(o,{type:h.join("&"),label:n,value:l,onChange:c});default:return r.a.createElement(o,{type:a,label:n,value:l,onChange:c})}};t.a=function(e){var t=e.keys,a=void 0===t?[]:t,n=e.fields,i=void 0===n?{}:n,o=e.row,s=void 0===o?{}:o,c=e.onChange;return r.a.createElement("div",null,a.map((function(e){return r.a.createElement(l,{type:i[e],key:e+i[e],label:e,value:s[e],onChange:c})})))}},65:function(e,t,a){e.exports={Month:a(97).default,FilterDate:a(201).default}},68:function(e,t,a){"use strict";var n=a(1),r=a.n(n),i=a(18);t.a=function(e){var t=e.modelName,a=e.id,n=e.show,o=e.onClose,s=e.onDelete;return r.a.createElement(i.Modal,{show:n,onClick:o},"Delete ".concat(t," #").concat(a),r.a.createElement("div",null,r.a.createElement("p",null,"Are you sure you want to delete these Records?"),r.a.createElement("small",{className:"text-danger"},"This action cannot be undone.")),r.a.createElement("button",{className:"btn btn-danger",onClick:s},"Delete"))}},71:function(e,t,a){"use strict";var n=a(17),r=a(12),i=a(8),o=a(9),s=a(5),l=a(11),c=a(10),u=a(1),m=a.n(u),d=a(13),h=a(15),f=a(18),p=a(48),g=a(68),b=a(16);var v=function(e){var t=e.onShow,a=e.onEdit,n=e.onDelete,r=Object(u.useState)(!1),i=Object(b.a)(r,2),o=i[0],s=i[1];return m.a.createElement("div",{className:"bi-container"},m.a.createElement("i",{className:"bi bi-btn ".concat(o?"bi-chevron-right":"bi-chevron-left"),onClick:function(){return s(!o)}}),m.a.createElement(h.a,{status:o},m.a.createElement("i",{className:"bi bi-btn bi-pencil",onClick:a}),m.a.createElement("i",{className:"bi bi-btn bi-plus",onClick:t}),m.a.createElement("i",{className:"bi bi-btn bi-trash",onClick:n})))};var k=function(e){var t=e.rows,a=void 0===t?[]:t,n=e.row,r=void 0===n?{}:n,i=e.modelName,o=Object(u.useState)(!1),s=Object(b.a)(o,2),l=s[0],c=s[1];return[m.a.createElement("li",{key:r.id,className:"list-group-item flex justify-content-between "},m.a.createElement("i",{className:"bi bi-btn ".concat(l?"bi-chevron-down":"bi-chevron-right"),onClick:function(){return c(!l)}}),r.title,m.a.createElement(v,{modelName:i,id:r.id,row:r})),m.a.createElement(h.a,{key:r.id+"list",status:l},m.a.createElement(w,{rows:a,parent:r.id,modelName:i}))]};var w=function(e){var t=e.rows,a=void 0===t?[]:t,n=e.parent,r=void 0===n?0:n,i=e.modelName,o=e.onDoubleClick;return 0===a.length||a[0].hasOwnProperty("parent")&&a[0].hasOwnProperty("isChildren")?m.a.createElement("ul",{className:"list-group list-group-flush"},a.filter((function(e){return e.parent===r})).map((function(e){return e.isChildren?m.a.createElement(k,{key:e.id+"listGroup",rows:a,row:e,modelName:i,onDoubleClick:o}):m.a.createElement("li",{key:e.id.toString(),className:"list-group-item flex justify-content-between",onDoubleClick:function(){return o(e)}},e.title,m.a.createElement(v,{modelName:i,id:e.id,row:e}))}))):m.a.createElement("ul",{className:"list-group list-group-flush"},a.map((function(e){return m.a.createElement("li",{key:e.id.toString(),className:"list-group-item flex justify-content-between",onDoubleClick:function(){return o(e)}},e.title,m.a.createElement(v,{modelName:i,id:e.id,row:e}))})))},E=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={rows:[]},n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){this.getAll()}},{key:"getAll",value:function(){var e=this;return this.context.api.list(this.props.modelName).then((function(t){return e.setState((function(){return{rows:t,isLoadding:!1}}))})).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"render",value:function(){var e=this.props,t=e.modelName,a=e.show,n=e.onClose,r=e.onSelect,i=this.state.rows;return m.a.createElement(f.Modal,{show:a,onClick:n,styleBody:{padding:0}},"Select ".concat(t),m.a.createElement(w,{modelName:t,rows:i,onDoubleClick:r}))}}]),a}(m.a.Component);E.contextType=d.a;var y=E,N=(a(204),function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).state={isLoadding:!1,showRows:!1,showModalAddRow:!1,showModalEditRow:!1,showModalDeleteRow:!1,showModalSelectRow:!1,deleteRowId:0,desctiption:{keys:[],fields:{}},row:{title:"Click for select"},rows:[],error:null},n.timerId=null,n.handlerChange=n.handlerChange.bind(Object(s.a)(n)),n.handleChangeRow=n.handleChangeRow.bind(Object(s.a)(n)),n.handlerSelectRow=n.handlerSelectRow.bind(Object(s.a)(n)),n.handleSelectNull=n.handleSelectNull.bind(Object(s.a)(n)),n.handleAddRow=n.handleAddRow.bind(Object(s.a)(n)),n.handleShowModalAddRow=n.handleShowModalAddRow.bind(Object(s.a)(n)),n.handleShowModalEditRow=n.handleShowModalEditRow.bind(Object(s.a)(n)),n.handleShowRowsIsFocus=n.handleShowRowsIsFocus.bind(Object(s.a)(n)),n.handleDeleteRow=n.handleDeleteRow.bind(Object(s.a)(n)),n.handleUpdateRow=n.handleUpdateRow.bind(Object(s.a)(n)),n.findByTitle=n.findByTitle.bind(Object(s.a)(n)),n.getRow=n.getRow.bind(Object(s.a)(n)),n}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.context.api.desctiption(this.props.modelName).then((function(t){return e.setState((function(){return{desctiption:t,isLoadding:!1}}))})).then(this.getRow).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"getRow",value:function(){var e=this,t=this.props,a=t.value,n=t.modelName;return a?this.context.api.view(n,a).then((function(t){return e.setState((function(){return{row:t.length>0?t[0]:{title:a}}}))})).catch((function(t){return e.setState((function(){return{error:t.message}}))})):null}},{key:"findByTitle",value:function(e){var t=this,a=this.context.api,n={};return e&&(n.title="LIKE-".concat(e)),this.props.hasOwnProperty("filter")&&(n=Object(r.a)(Object(r.a)({},n),this.props.filter)),a.list(this.props.modelName,n).then((function(e){return t.setState((function(){return{rows:e,isLoadding:!1}}))})).catch((function(e){return t.setState((function(){return{error:e.message}}))}))}},{key:"handleAddRow",value:function(){var e=this;this.setState({isLoadding:!0});var t=Object(r.a)(Object(r.a)({},this.state.row),this.props.filter);return this.context.api.add(this.props.modelName,t).then((function(){return e.findByTitle(e.state.row.title)})).then((function(){var t=e.state;return t.rows.find((function(e){return e.title===t.row.title}))})).then(this.handlerSelectRow).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"handleDeleteRow",value:function(){var e=this;return this.context.api.del(this.props.modelName,this.state.deleteRowId).then((function(){return e.setState((function(){return{showModalDeleteRow:!1,showModalEditRow:!1,rows:e.state.rows.filter((function(t){return t.id!==e.state.deleteRowId}))}}))})).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"handlerChange",value:function(e){var t=this,a=e.target.value;this.timerId&&clearTimeout(this.timerId),this.setState((function(e){return{row:{title:a}}}));this.timerId=setTimeout((function(){t.timerId=null,t.findByTitle(a)}),300)}},{key:"handlerShowRows",value:function(e){var t=this;if(e)return this.findByTitle().then((function(){return t.setState((function(){return{showRows:!0}}))})).catch((function(e){return t.setState((function(){return{error:e.message}}))}));this.setState((function(){return{showRows:e}}))}},{key:"handleShowRowsIsFocus",value:function(){var e=this;return this.findByTitle().then((function(){return e.setState((function(){return{showRows:!0,row:{title:""}}}))})).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"handleShowModalAddRow",value:function(e){this.setState((function(){return{showModalAddRow:e,row:{}}}))}},{key:"handleShowModalEditRow",value:function(e){this.state.row.hasOwnProperty("id")||(e=!1),this.setState((function(){return{showModalEditRow:e}}))}},{key:"handleChangeRow",value:function(e,t){var a=this;this.setState((function(){return{row:Object(r.a)(Object(r.a)({},a.state.row),{},Object(n.a)({},e,t))}}))}},{key:"handlerSelectRow",value:function(e){this.setState({showRows:!1,showModalAddRow:!1,showModalSelectRow:!1,row:e}),this.props.onChange&&this.props.onChange(this.props.label,e.id)}},{key:"handleSelectNull",value:function(){this.setState({showRows:!1,showModalSelectRow:!1,row:{title:""}}),this.props.onChange&&this.props.onChange(this.props.label,void 0)}},{key:"handleUpdateRow",value:function(){var e=this;return this.context.api.update(this.props.modelName,this.state.row,{id:this.state.row.id}).then((function(){return e.setState((function(e){return{showModalEditRow:!1,rows:e.rows.map((function(t){return t.id===e.row.id?e.row:t}))}}))})).catch((function(t){return e.setState((function(){return{error:t.message}}))}))}},{key:"render",value:function(){var e=this,t=this.props.label;return m.a.createElement("div",{className:"form-group mt-2",key:" modal form "+this.props.modelName},m.a.createElement(h.a,{status:!!t},m.a.createElement("label",{htmlFor:t},t)),m.a.createElement("div",{className:"input-group ".concat(this.state.showRows?"show":"")},m.a.createElement("input",{type:"text",id:t,className:"form-control Filter-input",placeholder:"Filter to model list",onChange:this.handlerChange,value:this.state.row.title,onFocus:this.handleShowRowsIsFocus}),m.a.createElement("div",{className:"input-group-append"},m.a.createElement("button",{className:"btn btn-outline-secondary Filter-btn-show",type:"button",onClick:this.handleShowModalEditRow},m.a.createElement("i",{className:"bi bi-files"})),m.a.createElement("button",{className:"btn btn-outline-secondary Filter-btn-show",onClick:function(){return e.handlerShowRows(!e.state.showRows)},type:"button"},m.a.createElement("i",{className:"bi bi-chevron-down"})))),m.a.createElement(h.a,{status:this.state.showRows},m.a.createElement("div",{className:"card Filter-list"},m.a.createElement("ul",{className:"list-group list-group-flush"},m.a.createElement(h.a,{status:0===this.state.rows.length&&""!==this.state.row.title},m.a.createElement("li",{className:"list-group-item Filter-list-item",onClick:this.handleAddRow},"Create")),this.state.rows.map((function(t){return m.a.createElement("li",{className:"list-group-item Filter-list-item flex justify-content-between",key:t.id+t.title,onClick:function(a){return a.target.classList.contains("list-group-item")?e.handlerSelectRow(t):e.setState((function(e){return{showModalDeleteRow:!0,deleteRowId:t.id}}))}},t.title,m.a.createElement("i",{className:"bi bi-x"}))}))),m.a.createElement("div",{className:"card-footer p-0 flex justify-content-end"},m.a.createElement("div",{className:"btn-group"},m.a.createElement("button",{className:"btn btn-outline-secondary",style:{borderRadius:0},onClick:this.handleSelectNull},m.a.createElement("i",{className:"bi bi-x"})),m.a.createElement("button",{className:"btn btn-outline-secondary",style:{borderRadius:0},onClick:function(){return e.setState((function(){return{showModalSelectRow:!0}}))}},m.a.createElement("i",{className:"bi bi-list-task"})),m.a.createElement("button",{className:"btn btn-outline-secondary",style:{borderRadius:"0 0 0.25rem 0"},onClick:function(){return e.handleShowModalAddRow(!0)}},m.a.createElement("i",{className:"bi bi-plus"})))))),m.a.createElement(h.a,{status:this.state.showModalAddRow},m.a.createElement(f.Modal,{show:this.state.showModalAddRow,onClick:function(){return e.handleShowModalAddRow(!1)}},"Add new ".concat(this.props.modelName),m.a.createElement(p.a,{row:this.state.row,keys:this.state.desctiption.keys,fields:this.state.desctiption.fields,onChange:this.handleChangeRow}),m.a.createElement("button",{className:"btn btn-success",onClick:this.handleAddRow},"Add"))),m.a.createElement(h.a,{status:this.state.showModalEditRow},m.a.createElement(f.Modal,{show:this.state.showModalEditRow,onClick:function(){return e.handleShowModalEditRow(!1)}},"Edit ".concat(this.props.modelName),m.a.createElement(p.a,{row:this.state.row,keys:this.state.desctiption.keys,fields:this.state.desctiption.fields,onChange:this.handleChangeRow}),m.a.createElement("button",{className:"btn btn-success",onClick:this.handleUpdateRow},"Update"),m.a.createElement("button",{className:"btn btn-danger",onClick:function(){return e.setState((function(e){return{showModalDeleteRow:!0,deleteRowId:e.row.id}}))}},"Delete"))),m.a.createElement(h.a,{status:this.state.showModalDeleteRow},m.a.createElement(g.a,{show:this.state.showModalDeleteRow,modelName:this.props.modelName,id:this.state.deleteRowId,onClose:function(){return e.setState((function(){return{showModalDeleteRow:!1}}))},onDelete:this.handleDeleteRow})),m.a.createElement(h.a,{status:this.state.showModalSelectRow},m.a.createElement(y,{show:this.state.showModalSelectRow,modelName:this.props.modelName,rows:this.state.rows,onClose:function(){return e.setState((function(){return{showModalSelectRow:!1}}))},onSelect:this.handlerSelectRow})))}}]),a}(m.a.Component));N.contextType=d.a;t.a=N},74:function(e,t,a){},97:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),i=(a(198),a(46));function o(e){var t=e.className,a=e.days,n=e.selectDay,o=e.date,s=e.currentMonth,l=e.currentDay,c=e.onClick;return a.map((function(e,a){if(s&&l===e)return r.a.createElement("div",{className:t,key:a},r.a.createElement("div",{className:"curretnDay",onClick:function(){return c(e)}},e));if(n&&o){var u=Object(i.formatDate)(new Date(o.getFullYear(),o.getMonth(),e));if(n.includes(u))return r.a.createElement("div",{className:t,key:a},r.a.createElement("div",{className:"selectDay",onClick:function(){return c(e)}},e))}return r.a.createElement("div",{className:t,key:a,onClick:function(){return c(e)}},e)}))}t.default=function(e){var t=e.date,a=e.select,n=e.onChange;t=new Date(t.getFullYear(),t.getMonth());var s=Object(i.getMonth)(t);return r.a.createElement("div",null,r.a.createElement("div",{className:"Month-title"},r.a.createElement("div",{onClick:function(){return n("month")}},t.toLocaleString("ru",{year:"numeric",month:"long"})),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return n("previous")},className:"btn"},"<"),r.a.createElement("button",{onClick:function(){return n("next")},className:"btn"},">"))),r.a.createElement("div",{className:"gridMont"},r.a.createElement(o,{onClick:function(){},className:"otherTextStyle",days:s[0]}),r.a.createElement(o,{onClick:function(){},className:"otherTextStyle",days:s[1]}),r.a.createElement(o,{onClick:n,days:s[2],currentMonth:s[4],currentDay:s[5],selectDay:a,date:t}),r.a.createElement(o,{onClick:function(){},className:"otherTextStyle",days:s[3]})))}}},[[191,1,2]]]);
//# sourceMappingURL=main.c00fdefe.chunk.js.map